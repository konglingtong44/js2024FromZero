ペネトレーションテスト演習：実行ステップ & 目的まとめ】

⸻

【第1ステップ】

実行内容：Amazon Inspector を有効化（初期設定）
目的：攻撃前に EC2 / ECR 環境の脆弱性・設定ミスを可視化し、事前診断を行う
	•	EC2 インスタンスや ECR イメージを対象に、CVE・パッチ未適用・SSM Agent の有無などを自動チェック
	•	初回スキャン結果を記録（後で攻撃後と比較するため）

⸻

【第2ステップ】

実行内容：Amazon GuardDuty を有効化
目的：攻撃者による不審な挙動（API 操作・通信）を検出する常時監視体制を整える
	•	CloudTrail、VPC Flow Logs、DNS Logs を監視対象としてアクティブ化
	•	この時点から不審なアクティビティの自動検知が開始される
	•	※GuardDuty は一度有効にすれば、以降は常駐で動作し続ける

⸻

【第3ステップ】

実行内容：Metasploit（外部侵入）＋ Pacu（内部攻撃）を実行
目的：実際の攻撃シナリオを模倣し、脆弱性悪用・特権昇格・横展開の可否を検証する
	•	Metasploit によるポートスキャン・脆弱性エクスプロイト・Shell取得などを試行
	•	Pacu にて Access Key を使った IAM 権限列挙・AssumeRole・リソースアクセスなどを実行
	•	攻撃ログ・成功／失敗結果を記録

⸻

【第4ステップ】

実行内容：Inspector の再スキャン結果 & GuardDuty の検知結果を確認
目的：攻撃によるシステムへの影響と、それが検出されたかどうかを分析・評価する
	•	Amazon Inspector のレポートを再確認し、攻撃前との差分（新たな CVE や構成変更）を特定
	•	Amazon GuardDuty の Findings を確認し、攻撃行為（Port Scan、API 異常呼び出し等）の検出有無を確認
	•	SNS や CloudWatch による通知があれば、それも合わせて確認

⸻

✅ 備考まとめ（補足）
	•	Inspector： 攻撃「前後」の状態を比較するために結果の記録が必要
	•	GuardDuty： 攻撃の「検知精度」を確認するために、Findings を見るだけでよい
	•	Metasploit / Pacu： それぞれ「外部からの侵入」「内部からの悪用」を想定した攻撃シナリオに使用
